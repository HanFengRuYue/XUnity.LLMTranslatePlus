<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="XUnity_LLMTranslatePlus.Views.TranslationSettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:XUnity_LLMTranslatePlus.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <ScrollViewer Padding="0,0,16,0">
        <StackPanel Spacing="24" Margin="0,0,0,24">
            <!-- 页面标题 -->
            <TextBlock Text="翻译设置" Style="{StaticResource TitleTextBlockStyle}"/>

            <!-- XUnity 配置 -->
            <Expander Header="XUnity 配置" IsExpanded="True" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
                <StackPanel Spacing="12" Margin="0,12,0,0" HorizontalAlignment="Stretch">
                        <!-- 游戏根目录 -->
                        <StackPanel Spacing="4">
                            <TextBlock Text="游戏根目录"/>
                            <Grid ColumnSpacing="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBox x:ConnectionId='18' x:Name="GameDirectoryTextBox" 
                                         Grid.Column="0"
                                         IsReadOnly="True"
                                         PlaceholderText="点击浏览按钮选择游戏目录"/>
                                
                                <Button x:ConnectionId='19' Grid.Column="1" 
                                        Content="浏览..." 
                                                                         />
                            </Grid>
                        </StackPanel>

                        <!-- 自动检测路径 -->
                        <ToggleSwitch x:ConnectionId='16' x:Name="AutoDetectPathToggle" 
                                      Header="自动检测 Translation 路径"
                                      IsOn="True"
                                      OnContent="已启用" 
                                      OffContent="已禁用"/>

                    <!-- 当前 Translation 文件路径 -->
                    <StackPanel Spacing="4">
                        <TextBlock Text="当前 Translation 文件路径"/>
                        <TextBlock x:ConnectionId='17' x:Name="CurrentTranslationPathText" 
                                   Text="未检测到" 
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   TextWrapping="Wrap"/>
                    </StackPanel>
                </StackPanel>
            </Expander>

            <!-- 翻译选项 -->
            <Expander Header="翻译选项" IsExpanded="True" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
                <StackPanel Spacing="12" Margin="0,12,0,0" HorizontalAlignment="Stretch">
                        <!-- 目标语言 -->
                        <StackPanel Spacing="4">
                            <TextBlock Text="目标语言"/>
                            <ComboBox x:ConnectionId='15' x:Name="TargetLanguageComboBox" 
                                      SelectedIndex="0"
                                      HorizontalAlignment="Stretch">
                                <ComboBoxItem Content="简体中文"/>
                                <ComboBoxItem Content="繁体中文"/>
                                <ComboBoxItem Content="英语"/>
                                <ComboBoxItem Content="日语"/>
                                <ComboBoxItem Content="韩语"/>
                                <ComboBoxItem Content="俄语"/>
                                <ComboBoxItem Content="法语"/>
                                <ComboBoxItem Content="德语"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- 源语言 -->
                        <StackPanel Spacing="4">
                            <TextBlock Text="源语言"/>
                            <ComboBox x:ConnectionId='14' x:Name="SourceLanguageComboBox" 
                                      SelectedIndex="0"
                                      HorizontalAlignment="Stretch">
                                <ComboBoxItem Content="自动检测"/>
                                <ComboBoxItem Content="日语"/>
                                <ComboBoxItem Content="英语"/>
                                <ComboBoxItem Content="韩语"/>
                                <ComboBoxItem Content="简体中文"/>
                                <ComboBoxItem Content="繁体中文"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- 保留特殊符号 -->
                        <CheckBox x:ConnectionId='10' x:Name="PreserveSpecialCharsCheckBox" 
                                  Content="保留游戏文本中的转义符和特殊符号" 
                                  IsChecked="True"/>

                        <!-- 实时监控 -->
                        <ToggleSwitch x:ConnectionId='11' x:Name="RealTimeMonitoringToggle" 
                                      Header="实时监控翻译文件"
                                      IsOn="True"
                                      OnContent="已启用" 
                                      OffContent="已禁用"
                                                                                />

                    <!-- 文件监控间隔 -->
                    <StackPanel x:ConnectionId='12' x:Name="MonitorIntervalPanel" Spacing="4">
                        <TextBlock Text="文件监控间隔（毫秒）"/>
                        <NumberBox x:ConnectionId='13' x:Name="MonitorIntervalNumberBox" 
                                   Value="500" 
                                   Minimum="100" 
                                   Maximum="5000"
                                   SpinButtonPlacementMode="Inline"/>
                    </StackPanel>
                </StackPanel>
            </Expander>

            <!-- 上下文配置 -->
            <Expander Header="上下文配置" IsExpanded="False" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
                <StackPanel Spacing="12" Margin="0,12,0,0" HorizontalAlignment="Stretch">
                        <!-- 启用上下文参考 -->
                        <ToggleSwitch x:ConnectionId='5' x:Name="EnableContextToggle" 
                                      Header="启用上下文参考"
                                      IsOn="False"
                                      OnContent="已启用" 
                                      OffContent="已禁用"
                                                                           />

                        <!-- 上下文配置面板 -->
                        <StackPanel x:ConnectionId='6' x:Name="ContextConfigPanel" 
                                    Spacing="12" 
                                    Visibility="Collapsed">
                            <!-- 上下文行数 -->
                            <StackPanel Spacing="4">
                                <TextBlock Text="上下文行数（前后各 N 行）"/>
                                <NumberBox x:ConnectionId='9' x:Name="ContextLinesNumberBox" 
                                           Value="3" 
                                           Minimum="1" 
                                           Maximum="10"
                                           SpinButtonPlacementMode="Inline"/>
                            </StackPanel>

                            <!-- 上下文权重 -->
                            <StackPanel Spacing="4">
                                <Grid>
                                    <TextBlock Text="上下文权重" HorizontalAlignment="Left"/>
                                    <TextBlock x:ConnectionId='8' x:Name="ContextWeightValueText" 
                                               Text="0.5" 
                                               HorizontalAlignment="Right"/>
                                </Grid>
                                <Slider x:ConnectionId='7' x:Name="ContextWeightSlider" 
                                        Minimum="0" 
                                        Maximum="1" 
                                        StepFrequency="0.1" 
                                        Value="0.5"
                                                                                       />
                            </StackPanel>

                        <InfoBar Severity="Informational" 
                                 IsOpen="True" 
                                 IsClosable="False"
                                 Message="启用上下文参考可以提高翻译质量，但会增加 API 调用成本。"/>
                    </StackPanel>
                </StackPanel>
            </Expander>

            <!-- 输出配置 -->
            <Expander Header="输出配置" IsExpanded="False" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
                <StackPanel Spacing="12" Margin="0,12,0,0" HorizontalAlignment="Stretch">
                        <ToggleSwitch x:ConnectionId='3' x:Name="EnableCacheToggle" 
                                      Header="启用翻译缓存（避免重复翻译相同文本）"
                                      IsOn="True"
                                      OnContent="已启用" 
                                      OffContent="已禁用"/>
                        
                    <CheckBox x:ConnectionId='4' x:Name="ExportLogCheckBox" 
                              Content="导出翻译日志（记录所有翻译操作）" 
                              IsChecked="False"/>
                </StackPanel>
            </Expander>

            <!-- 保存按钮 -->
            <Button x:ConnectionId='2' Style="{StaticResource AccentButtonStyle}"
                                                    
                    HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <FontIcon Glyph="&#xE74E;" FontSize="16"/>
                    <TextBlock Text="保存设置"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </ScrollViewer>
</Page>


