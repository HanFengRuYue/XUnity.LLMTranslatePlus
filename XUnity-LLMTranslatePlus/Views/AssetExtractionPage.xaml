<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="XUnity_LLMTranslatePlus.Views.AssetExtractionPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls"
    mc:Ignorable="d">

    <Grid>
        <!-- ä¸»å†…å®¹åŒº -->
        <ScrollViewer Padding="0,0,16,0" HorizontalScrollBarVisibility="Disabled">
            <StackPanel Spacing="16" Margin="0,0,0,24" HorizontalAlignment="Stretch">
                <!-- é¡µé¢æ ‡é¢˜ -->
                <TextBlock Text="Unity èµ„äº§æ–‡æœ¬æå–" Style="{StaticResource TitleTextBlockStyle}"/>

                <!-- ä¿¡æ¯æç¤º -->
                <InfoBar Severity="Informational"
                         IsOpen="True"
                         IsClosable="False"
                         Message="ä»Žæ¸¸æˆèµ„äº§æ–‡ä»¶ä¸­é¢„å…ˆæå–å’Œç¿»è¯‘æ–‡æœ¬ï¼Œé…åˆå®žæ—¶ç›‘æŽ§åŠŸèƒ½æå‡ç¿»è¯‘æ•ˆçŽ‡"/>

                <!-- æ‰«æè®¾ç½® -->
                <Expander Header="æ‰«æè®¾ç½®" IsExpanded="True" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
                    <StackPanel Spacing="12" Margin="0,12,0,0" HorizontalAlignment="Stretch">
                        <!-- åŸºæœ¬æ‰«æé€‰é¡¹ -->
                        <CheckBox x:Name="ScanTextAssetsCheckBox"
                                  Content="æ‰«æ TextAssetï¼ˆå¯¹è¯ã€é…ç½®æ–‡ä»¶ï¼‰"
                                  IsChecked="True"/>
                        <CheckBox x:Name="ScanMonoBehavioursCheckBox"
                                  Content="æ‰«æ MonoBehaviourï¼ˆè‡ªå®šä¹‰è„šæœ¬ï¼‰"
                                  IsChecked="True"/>

                        <!-- è¯­è¨€è¿‡æ»¤ -->
                        <StackPanel Spacing="4">
                            <TextBlock Text="æºè¯­è¨€è¿‡æ»¤"/>
                            <ComboBox x:Name="SourceLanguageComboBox"
                                      SelectedIndex="0"
                                      HorizontalAlignment="Stretch"
                                      SelectionChanged="SourceLanguageComboBox_SelectionChanged">
                                <ComboBoxItem Content="å…¨éƒ¨è¯­è¨€"/>
                                <ComboBoxItem Content="ä¸­æ—¥éŸ©ï¼ˆCJKï¼‰"/>
                                <ComboBoxItem Content="ç®€ä½“ä¸­æ–‡"/>
                                <ComboBoxItem Content="ç¹ä½“ä¸­æ–‡"/>
                                <ComboBoxItem Content="æ—¥è¯­"/>
                                <ComboBoxItem Content="è‹±è¯­"/>
                                <ComboBoxItem Content="éŸ©è¯­"/>
                                <ComboBoxItem Content="ä¿„è¯­"/>
                            </ComboBox>
                            <TextBlock Text="é€‰æ‹©è¦æå–çš„æ¸¸æˆæ–‡æœ¬è¯­è¨€ã€‚é»˜è®¤æå–æ‰€æœ‰è¯­è¨€çš„æ–‡æœ¬ã€‚"
                                       Style="{StaticResource CaptionTextBlockStyle}"
                                       Opacity="0.6"
                                       TextWrapping="Wrap"/>
                        </StackPanel>

                        <!-- ClassDatabase æ–‡ä»¶é€‰æ‹© -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="ClassDatabase æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰" Style="{StaticResource BodyTextBlockStyle}" Opacity="0.7"/>
                            <Grid ColumnSpacing="8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBox x:Name="ClassDatabasePathTextBox"
                                         Grid.Column="0"
                                         PlaceholderText="æœªæŒ‡å®šï¼ˆå°†ä½¿ç”¨ç¨‹åºå†…ç½®çš„ classdata.tpkï¼‰"
                                         IsReadOnly="True"/>
                                <Button x:Name="BrowseClassDatabaseButton"
                                        Grid.Column="1"
                                        Content="æµè§ˆ"
                                        Click="BrowseClassDatabaseButton_Click"/>
                                <Button x:Name="ClearClassDatabaseButton"
                                        Grid.Column="2"
                                        Content="æ¸…é™¤"
                                        Click="ClearClassDatabaseButton_Click"/>
                            </Grid>
                            <TextBlock Text="ç¨‹åºå·²å†…ç½® classdata.tpkï¼Œé€šå¸¸æ— éœ€æ‰‹åŠ¨æŒ‡å®šã€‚ä»…åœ¨éœ€è¦ä½¿ç”¨è‡ªå®šä¹‰ç‰ˆæœ¬æ—¶é€‰æ‹©ã€‚"
                                       Style="{StaticResource CaptionTextBlockStyle}"
                                       Opacity="0.6"
                                       TextWrapping="Wrap"/>
                        </StackPanel>
                    </StackPanel>
                </Expander>

                <!-- MonoBehaviour æ‰«ææ¨¡å¼ -->
                <StackPanel Spacing="12">
                    <TextBlock Text="MonoBehaviour æ‰«ææ¨¡å¼" FontWeight="SemiBold"/>
                    <RadioButtons x:Name="ScanModeRadioButtons" SelectionChanged="ScanModeRadioButtons_SelectionChanged">
                        <RadioButton x:Name="SpecifiedFieldsRadioButton" Content="ä»…æ‰«ææŒ‡å®šå­—æ®µå" IsChecked="True" Tag="SpecifiedFields"/>
                        <RadioButton x:Name="AllStringFieldsRadioButton" Content="æ‰«ææ‰€æœ‰å­—ç¬¦ä¸²å­—æ®µï¼ˆæ™ºèƒ½è¿‡æ»¤ï¼‰" Tag="AllStringFields"/>
                    </RadioButtons>
                    <TextBlock Text="é€‰æ‹©å¦‚ä½•æ‰«æ MonoBehaviour ä¸­çš„æ–‡æœ¬å­—æ®µã€‚æŒ‡å®šå­—æ®µåæ¨¡å¼æ›´ç²¾ç¡®ï¼Œæ™ºèƒ½è¿‡æ»¤æ¨¡å¼æ›´å…¨é¢ã€‚"
                               Style="{StaticResource CaptionTextBlockStyle}"
                               Opacity="0.6"
                               TextWrapping="Wrap"/>
                </StackPanel>

                <!-- MonoBehaviour å­—æ®µåç®¡ç† -->
                <Expander x:Name="FieldNamesExpander" Header="MonoBehaviour å­—æ®µåç®¡ç†" IsExpanded="False" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
                    <StackPanel Spacing="12" Margin="0,12,0,0" HorizontalAlignment="Stretch">
                        <!-- å·¥å…·æ  -->
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <Button Click="AddFieldButton_Click">
                                <StackPanel Orientation="Horizontal" Spacing="6">
                                    <FontIcon Glyph="&#xE710;" FontSize="14"/>
                                    <TextBlock Text="æ·»åŠ å­—æ®µ"/>
                                </StackPanel>
                            </Button>
                            <Button x:Name="DeleteFieldButton" Click="DeleteFieldButton_Click" IsEnabled="False">
                                <StackPanel Orientation="Horizontal" Spacing="6">
                                    <FontIcon Glyph="&#xE74D;" FontSize="14"/>
                                    <TextBlock Text="åˆ é™¤"/>
                                </StackPanel>
                            </Button>
                            <TextBlock x:Name="FieldCountText"
                                       Text=""
                                       VerticalAlignment="Center"
                                       Margin="8,0,0,0"
                                       Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                        </StackPanel>

                        <!-- å­—æ®µååˆ—è¡¨ -->
                        <ListView x:Name="FieldNamesListView"
                                  Height="200"
                                  BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                  BorderThickness="1"
                                  CornerRadius="4"
                                  SelectionMode="Extended"
                                  SelectionChanged="FieldNamesListView_SelectionChanged">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    <Setter Property="Padding" Value="0"/>
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.HeaderTemplate>
                                <DataTemplate>
                                    <Grid Padding="16,8" MinHeight="40">
                                        <TextBlock Text="å­—æ®µå" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.HeaderTemplate>
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="16,12" MinHeight="48">
                                        <TextBox Text="{Binding FieldName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                 VerticalAlignment="Center"
                                                 PlaceholderText="å­—æ®µåï¼ˆå¦‚ï¼štext, message, contentï¼‰"
                                                 BorderThickness="1"
                                                 TextChanged="FieldNameTextBox_TextChanged"/>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>

                        <InfoBar Severity="Informational"
                                 IsOpen="True"
                                 IsClosable="False"
                                 Message="é…ç½®è¦ä»Ž MonoBehaviour ä¸­æå–çš„å­—æ®µåã€‚å¸¸ç”¨å­—æ®µåå·²é¢„è®¾ï¼Œæ‚¨å¯ä»¥æ·»åŠ è‡ªå®šä¹‰å­—æ®µä»¥é€‚åº”ä¸åŒæ¸¸æˆã€‚"/>
                    </StackPanel>
                </Expander>

                <!-- é«˜çº§è¿‡æ»¤è®¾ç½®ï¼ˆä»…åœ¨æ‰«ææ‰€æœ‰å­—ç¬¦ä¸²å­—æ®µæ¨¡å¼ä¸‹æ˜¾ç¤ºï¼‰ -->
                <Expander x:Name="AdvancedFilterExpander" Header="é«˜çº§è¿‡æ»¤è®¾ç½®" IsExpanded="False" Visibility="Collapsed" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
                    <StackPanel Spacing="16" Margin="0,12,0,0" HorizontalAlignment="Stretch">
                        <!-- é€’å½’æ·±åº¦è®¾ç½® -->
                        <StackPanel Spacing="8">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="é€’å½’æ‰«ææ·±åº¦" VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="1" x:Name="RecursionDepthText" Text="3" FontWeight="SemiBold" VerticalAlignment="Center"/>
                            </Grid>
                            <Slider x:Name="RecursionDepthSlider"
                                    Minimum="1"
                                    Maximum="5"
                                    Value="3"
                                    StepFrequency="1"
                                    TickFrequency="1"
                                    TickPlacement="BottomRight"
                                    ValueChanged="RecursionDepthSlider_ValueChanged"/>
                            <TextBlock Text="é™åˆ¶åµŒå¥—å¯¹è±¡çš„æ‰«ææ·±åº¦ã€‚æ·±åº¦è¶Šå¤§æå–è¶Šå…¨é¢ï¼Œä½†å¯èƒ½åŒ…å«æ›´å¤šæŠ€æœ¯æ€§å­—æ®µã€‚"
                                       Style="{StaticResource CaptionTextBlockStyle}"
                                       Opacity="0.6"
                                       TextWrapping="Wrap"/>
                        </StackPanel>

                        <!-- å­—æ®µåé»‘åå•ç®¡ç† -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="å­—æ®µåé»‘åå•" Style="{StaticResource BodyTextBlockStyle}" Opacity="0.7"/>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Button Click="AddExcludeFieldButton_Click">
                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                        <FontIcon Glyph="&#xE710;" FontSize="14"/>
                                        <TextBlock Text="æ·»åŠ "/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="DeleteExcludeFieldButton" Click="DeleteExcludeFieldButton_Click" IsEnabled="False">
                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                        <FontIcon Glyph="&#xE74D;" FontSize="14"/>
                                        <TextBlock Text="åˆ é™¤"/>
                                    </StackPanel>
                                </Button>
                                <TextBlock x:Name="ExcludeFieldCountText"
                                           Text=""
                                           VerticalAlignment="Center"
                                           Margin="8,0,0,0"
                                           Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                            </StackPanel>
                            <ListView x:Name="ExcludeFieldNamesListView"
                                      Height="300"
                                      BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                      BorderThickness="1"
                                      CornerRadius="4"
                                      SelectionMode="Extended"
                                      SelectionChanged="ExcludeFieldNamesListView_SelectionChanged">
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="Padding" Value="0"/>
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.HeaderTemplate>
                                    <DataTemplate>
                                        <Grid Padding="16,8" MinHeight="40">
                                            <TextBlock Text="å­—æ®µåï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.HeaderTemplate>
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Padding="16,12" MinHeight="48">
                                            <TextBox Text="{Binding FieldName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                     VerticalAlignment="Center"
                                                     PlaceholderText="å­—æ®µåï¼ˆå¦‚ï¼šguid, id, pathï¼‰"
                                                     BorderThickness="1"
                                                     TextChanged="ExcludeFieldNameTextBox_TextChanged"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                            <InfoBar Severity="Informational"
                                     IsOpen="True"
                                     IsClosable="False"
                                     Message="é…ç½®è¦æŽ’é™¤çš„æŠ€æœ¯æ€§å­—æ®µåã€‚åŒ¹é…è¿™äº›å­—æ®µåçš„å­—ç¬¦ä¸²å°†è¢«è¿‡æ»¤æŽ‰ã€‚"/>
                        </StackPanel>

                        <!-- æŽ’é™¤æ¨¡å¼ç®¡ç† -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="æŽ’é™¤æ¨¡å¼ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰" Style="{StaticResource BodyTextBlockStyle}" Opacity="0.7"/>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Button Click="AddExcludePatternButton_Click">
                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                        <FontIcon Glyph="&#xE710;" FontSize="14"/>
                                        <TextBlock Text="æ·»åŠ "/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="DeleteExcludePatternButton" Click="DeleteExcludePatternButton_Click" IsEnabled="False">
                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                        <FontIcon Glyph="&#xE74D;" FontSize="14"/>
                                        <TextBlock Text="åˆ é™¤"/>
                                    </StackPanel>
                                </Button>
                                <TextBlock x:Name="ExcludePatternCountText"
                                           Text=""
                                           VerticalAlignment="Center"
                                           Margin="8,0,0,0"
                                           Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                            </StackPanel>
                            <ListView x:Name="ExcludePatternsListView"
                                      Height="300"
                                      BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                      BorderThickness="1"
                                      CornerRadius="4"
                                      SelectionMode="Extended"
                                      SelectionChanged="ExcludePatternsListView_SelectionChanged">
                                <ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                        <Setter Property="Padding" Value="0"/>
                                    </Style>
                                </ListView.ItemContainerStyle>
                                <ListView.HeaderTemplate>
                                    <DataTemplate>
                                        <Grid Padding="16,8" MinHeight="40">
                                            <TextBlock Text="æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.HeaderTemplate>
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Padding="16,12" MinHeight="48">
                                            <TextBox Text="{Binding Pattern, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                     VerticalAlignment="Center"
                                                     PlaceholderText="æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¦‚ï¼š^\{.*\}$ï¼‰"
                                                     BorderThickness="1"
                                                     FontFamily="Consolas"
                                                     TextChanged="ExcludePatternTextBox_TextChanged"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                            <InfoBar Severity="Informational"
                                     IsOpen="True"
                                     IsClosable="False"
                                     Message="é…ç½®æ­£åˆ™è¡¨è¾¾å¼æ¥æŽ’é™¤åŒ¹é…çš„æ–‡æœ¬ã€‚å³é”®ç‚¹å‡»æå–ç»“æžœå¯å¿«é€Ÿæ·»åŠ æ™ºèƒ½ç”Ÿæˆçš„æŽ’é™¤æ¨¡å¼ã€‚"/>
                        </StackPanel>
                    </StackPanel>
                </Expander>

                <!-- æ“ä½œæŒ‰é’® -->
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <Button x:Name="ScanButton" Click="ScanButton_Click" Style="{StaticResource AccentButtonStyle}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE721;" FontSize="16"/>
                            <TextBlock Text="å¼€å§‹æ‰«æ"/>
                        </StackPanel>
                    </Button>

                    <Button x:Name="TranslateButton" Click="TranslateButton_Click" IsEnabled="False">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE8C1;" FontSize="16"/>
                            <TextBlock Text="å¼€å§‹ç¿»è¯‘"/>
                        </StackPanel>
                    </Button>

                    <Button x:Name="CancelButton" Click="CancelButton_Click" IsEnabled="False">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE711;" FontSize="16"/>
                            <TextBlock Text="å–æ¶ˆ"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- è¿›åº¦æ˜¾ç¤º -->
                <StackPanel Spacing="8" x:Name="ProgressPanel" Visibility="Collapsed">
                    <TextBlock x:Name="ProgressText" Style="{StaticResource BodyTextBlockStyle}"/>
                    <ProgressBar x:Name="ProgressBar" IsIndeterminate="False"/>
                </StackPanel>

                <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                <Grid x:Name="StatsGrid" Visibility="Collapsed" ColumnSpacing="12" RowSpacing="8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Grid.Column="0" Text="æ‰«æèµ„äº§:" Opacity="0.7"/>
                    <TextBlock Grid.Row="0" Grid.Column="1" x:Name="AssetCountText" Text="0"/>

                    <TextBlock Grid.Row="1" Grid.Column="0" Text="æå–æ–‡æœ¬:" Opacity="0.7"/>
                    <TextBlock Grid.Row="1" Grid.Column="1" x:Name="ExtractedTextCountText" Text="0"/>

                    <TextBlock Grid.Row="2" Grid.Column="0" Text="æˆåŠŸç¿»è¯‘:" Opacity="0.7"/>
                    <TextBlock Grid.Row="2" Grid.Column="1" x:Name="TranslatedCountText" Text="0"/>

                    <TextBlock Grid.Row="3" Grid.Column="0" Text="å¤±è´¥:" Opacity="0.7"/>
                    <TextBlock Grid.Row="3" Grid.Column="1" x:Name="FailedCountText" Text="0"/>
                </Grid>

                <!-- æå–æ–‡æœ¬åˆ—è¡¨ -->
                <StackPanel x:Name="ExtractedTextsPanel" Visibility="Collapsed" Spacing="12" Margin="0,12,0,0">
                    <TextBlock Text="æå–çš„æ–‡æœ¬" Style="{StaticResource SubtitleTextBlockStyle}"/>

                    <!-- æœç´¢å’Œç­›é€‰ -->
                    <Grid ColumnSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBox x:Name="SearchTextBox"
                                 Grid.Column="0"
                                 PlaceholderText="æœç´¢æ–‡æœ¬æˆ–æ¥æºæ–‡ä»¶..."
                                 TextChanged="SearchTextBox_TextChanged">
                            <TextBox.KeyboardAccelerators>
                                <KeyboardAccelerator Key="F" Modifiers="Control"/>
                            </TextBox.KeyboardAccelerators>
                        </TextBox>

                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                            <Button x:Name="SelectAllButton" Content="å…¨é€‰" Click="SelectAllButton_Click"/>
                            <Button x:Name="DeselectAllButton" Content="å–æ¶ˆå…¨é€‰" Click="DeselectAllButton_Click"/>
                        </StackPanel>
                    </Grid>

                    <!-- ç»Ÿè®¡ -->
                    <TextBlock x:Name="ExtractedTextsStats"
                               Style="{StaticResource CaptionTextBlockStyle}"
                               Opacity="0.7"/>

                    <!-- æ–‡æœ¬åˆ—è¡¨ -->
                    <Border BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Height="600">
                        <controls:DataGrid x:Name="ExtractedTextsDataGrid"
                                          AutoGenerateColumns="False"
                                          CanUserResizeColumns="True"
                                          CanUserSortColumns="True"
                                          GridLinesVisibility="Horizontal"
                                          HeadersVisibility="Column"
                                          SelectionMode="Extended"
                                          IsReadOnly="True"
                                          VerticalScrollBarVisibility="Auto"
                                          HorizontalScrollBarVisibility="Auto"
                                          SelectionChanged="ExtractedTextsDataGrid_SelectionChanged">

                            <!-- å³é”®èœå• -->
                            <controls:DataGrid.ContextFlyout>
                                <MenuFlyout>
                                    <MenuFlyoutItem Text="ðŸ“‹ å¤åˆ¶åŽŸæ–‡" Click="CopyTextMenuItem_Click"/>
                                    <MenuFlyoutItem Text="ðŸ“„ å¤åˆ¶å­—æ®µè·¯å¾„" Click="CopyFieldPathMenuItem_Click"/>
                                    <MenuFlyoutItem Text="ðŸ“ å¤åˆ¶æ¥æºæ–‡ä»¶" Click="CopySourcePathMenuItem_Click"/>
                                    <MenuFlyoutSeparator/>
                                    <MenuFlyoutItem Text="âž• æ·»åŠ å­—æ®µååˆ°é»‘åå•" Click="AddFieldToBlacklistMenuItem_Click"/>
                                    <MenuFlyoutItem Text="ðŸš« æ·»åŠ åˆ°æŽ’é™¤æ¨¡å¼" Click="AddToExcludePatternMenuItem_Click"/>
                                </MenuFlyout>
                            </controls:DataGrid.ContextFlyout>

                            <!-- åˆ—å®šä¹‰ -->
                            <controls:DataGrid.Columns>
                                <controls:DataGridTextColumn Header="åŽŸæ–‡"
                                                            Binding="{Binding Text}"
                                                            Width="3*"
                                                            MinWidth="200"/>
                                <controls:DataGridTextColumn Header="æ¥æºæ–‡ä»¶"
                                                            Binding="{Binding RelativeSourcePath}"
                                                            Width="2*"
                                                            MinWidth="150"/>
                                <controls:DataGridTextColumn Header="ç±»åž‹"
                                                            Binding="{Binding AssetType}"
                                                            Width="100"/>
                                <controls:DataGridTextColumn Header="å­—æ®µå"
                                                            Binding="{Binding FieldName}"
                                                            Width="120"/>
                            </controls:DataGrid.Columns>
                        </controls:DataGrid>
                    </Border>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
